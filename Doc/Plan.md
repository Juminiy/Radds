# Graduation Project

> ZH_CN 简体中文

关键字：初步想法，将要实现的东西，给自己挖的坑

## 分布式存储系统

### 服务端

- C做为底层Key-Value存储引擎
  - C作为底层语言，在存储日志文件和二进制数据上有极大的优越性，有利于减少内存碎片化，保持磁盘块完整度，提高上层API调用速率
  - gRPC不提供对于原始C的gRPC标准，但是支持C++的gRPC，可以利用GNU C++标准C/C++混合编译特性，C++可以无缝调用C的存储原语
  - 开源的包管理工具基本不可用，所有细节不得不自造轮子

- 基于Raft的分布式共识算法
  - 已经有多种工业界完整实现可供阅读参考：
    - hashicorp/raft
    
    - coreos/raft
    
    - goraft/raft
    
      
  
- Go通过gRPC与C的API通信调用C的API，作为上层模型
    - Go更适合并发编程与分布式协调
    - defer，group能够优雅的处理并发
    - Go哲学：通信来共享内存
    - GMP机制，可维护性高
    - 更好的GC算法，在crash后快速定位错误
  - 开源生态好，可使用的开源库多，有些细节不必自造轮子


### 客户端

- Prometheus+Grafana监控系统面板的**插件**
  - Prometheus是一个时序型数据库，非常适合用来存储时间序列版本类型的数据，以便于通过曲线来分析流量特征和系统稳定性
  - Grafana可视化监控面板，Grafana商场已经为我们提供了很多原始的监控面板插件如：MySQL，K8s，OpenStack，我只需要很少的代价来用`typescript`**开发一个插件**来使得数据存储与RPC数据传输**可视化**

### 最终实现

- C/C++的存储引擎是一个可执行文件`my-engine`，Go实现`my-raft`用gRPC和`my-engine`在一个机器上**进程间通信**。
- 所有机器上都存在`my-engine`和`my-raft`，机器之间通过gRPC**机器间通信**（逻辑上：集群机器的角色不同，只有一个`leader`，其余是`follower`，物理上不存在差别）
- 在所有机器上都安装一个`my-cli`程序，可以使用命令行获取数据
- 监控面板可以看到数据特征和集群网络包监控信息

### Paper

> 论文只做为设计参考，和最终实现关联性小

#### 已经阅读过

| Paper                                              | 俗称      | Years | 发布的组织/企业/学校 |
| -------------------------------------------------- | --------- | ----- | -------------------- |
| MapReduce                                          | MapReduce | 2004  | Google Inc.          |
| The Google File System                             | GFS       | 2003  | Google Inc.          |
| Fault-Tolerant Virtual Machine                     | FTVM      | 2010  | VMWare Inc.          |
| In Search of an Understandable Consensus Algorithm | Raft      | 2014  | Stanford Edu.        |

#### 将要阅读的

| Paper     | 俗称    | Years | 发布组织       | 用处                                            |
| --------- | ------- | ----- | -------------- | ----------------------------------------------- |
| Spanner   | Spanner | 2012  | Google Inc.    | 基于Paxos算法，代码闭源，无法窥探全貌，意义有限 |
| Zookeeper | ZK      | 2010  | Yahoo Inc.     | 分布式领导选举方案，用于调度基于Hadoop的集群    |
| FARM      | Farm    | 2015  | Microsoft Inc. | 权衡分布式事务的一致性，高可用，性能            |
| Spark     | Spark   | 2012  | Berkeley Edu.  | 分布式数据集合，内存计算，错误容忍              |

### 已经掌握可用知识

- C语言（GNU GCC 9.4.0标准）


- Linux环境下开发
  - HTTP RESTful API
  - gRPC Client/Server
  - Bash，Shell编程
  - GCC工具链：Makefile，GDB
- Go语言：gRPC-Go，CLI，Web，Concurrency
- 前端语言：HTML,ES6标准

### 已经熟悉工具框架

- 容器，虚拟化：Docker，KVM，Kubernetes，QEMU
- 分布式相关：Zookeeper，Dubbo，Vagrant
- 调试相关：Shell，GCC

### 已经阅读过的源码

- Redis7.0-master

  纯C实现的内存型K-V存储引擎，分布式方案为哨兵机制，无借鉴性，只有内存计算部分可供学习领会
- ETCD release-3.0 

  全Go实现的持久化K-V存储引擎，分布式方案为Raft，借鉴性高

### 个人的感悟和反思

>  在经历了大二操作系统参赛后的失败，我有很多反思

1. 做超出自己能力范围之外的事情，虽然不是不可以，但要慎重考虑
2. 对os理解浅显，根本不清楚操作系统，os不只是书本的内容，而经过大三一年的不断学习，对于操作系统有了更深层次的理解：
   - 没有工具，不做系统：程序设计的正确性依赖于是否能对给出合适的测试用例与成熟的调试工具，如果不能掌握这些工具的使用，并且不能给出符合实际的分析测试方法，等同于白干一通
   - 操作系统是个相对的概念，中央控制工具都可以是操作系统：Linux/Win是上层软件的操作系统，Hadoop是整个数据集群的操作系统，K8s是容器集群的操作系统 . . . . . . 
   - 虚拟化，虚拟化是操作系统最重要的概念，从BIOS/UEFI硬件开始，计算机开始虚拟化：BIOS来模拟Firmware行为，操作系统模拟硬件行为来调度资源，使用虚拟化调度机器
3. 自己调试，阅读文档和文献，不麻烦他人。有些情况是你对他人说了他也不知晓你当前的问题所在，即使对方知识储备丰富以至于能解决你的问题，也会因为开发环境不同而产生问题隔阂，最终的结果也是相当痛苦。

### 对于毕业设计的完成信心

1. 所谓分布式存储，核心当然是存储，但是个人开发肯定不比团队，自己本科三年所学也有限，必然要抛弃集中数据库的存储引擎和SQL分析。尽可能使用多种数据结构的组合和现有K-V键值数据库的论文理论和现有的开源方案，尽可能完成一个简单的实现
2. 对于上述所提到的所有的开源工具，框架，协议及他们用法，在过去三年都已经尝试涉猎过，我才有勇气去完成这样一个构想，希望老师多给些建议
3. 刚刚收到老师您的通知，因为已经在复习考研阶段，但也会定期向您回报我的进度，争取完成一个合格的毕设。
